<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/security"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">
	
	<!-- static resource won't be filtered -->
	<http pattern="/css/**" security="none"></http>  
    <http pattern="/fonts/**" security="none"></http>
    <http pattern="/js/**" security="none"></http>
    
    <!-- Except login -->
    <!-- <http pattern="/Login.jsp" security="none"></http> -->
    
    <http disable-url-rewriting="false" auto-config="true">
		<!-- <headers disabled="true"/> -->
		<csrf disabled="true"/>
		
		<access-denied-handler error-page="/authFailed" />
		<intercept-url pattern="/loginInit" access="permitAll"/>
		<intercept-url pattern="/loginOneUser" access="permitAll"/>
		<intercept-url pattern="/authFailed" access="permitAll"/>
		<intercept-url pattern="/**" access="hasRole('ADMIN')"/>
		<form-login login-page="/loginInit" default-target-url="/loginRedirect" always-use-default-target="true" />
		<logout logout-url="/logout"/>
	</http>
	
	<!-- <authentication-manager>
		<authentication-provider>
			<user-service>
				<user name="user" password="password" authorities="ROLE_USER" />
				<user name="admin" password="password" authorities="ROLE_USER,ROLE_ADMIN" />
			</user-service>
		</authentication-provider>
	</authentication-manager> -->
	<authentication-manager alias="authManager">
		<authentication-provider user-service-ref="authService"/>
	</authentication-manager>
	
	<global-method-security pre-post-annotations="enabled" />
	
	<!-- Access Deny Part -->
	<!-- <beans:bean id="accessDeniedHandler" class="org.springframework.security.web.access.AccessDeniedHandlerImpl">
		<beans:property name="errorPage" value="/errorpage"/>
	</beans:bean> -->
	
	<!-- Authentication service part -->
	<beans:bean id="authService" class="com.sjw.bookcapture.serviceImpl.AuthenticationServiceImpl">
		<beans:property name="authDao" ref="authDao"/>
		<beans:property name="userCache" ref="userCache" />
	</beans:bean>
	
	<!-- Use usercache part-->
	<beans:bean id="userCache" class="org.springframework.security.core.userdetails.cache.EhCacheBasedUserCache">
		 <beans:property name="cache" ref="userEhCache" />
	</beans:bean>
	
	<beans:bean id="userEhCache" class="org.springframework.cache.ehcache.EhCacheFactoryBean">  
    	<beans:property name="cacheName" value="userCache" />  
    	<beans:property name="cacheManager" ref="cacheManager" />  
	</beans:bean>
	
	<beans:bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" />  

</beans:beans>